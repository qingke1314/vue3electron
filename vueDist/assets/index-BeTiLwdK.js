import{w as E,d as F,t as K,r as C,b as L,e as T,f as q,g as G,h as x,n as B,i as H,j as $,o as k,u as W,_ as J,k as D,c as Q,l as p,a as P,m as S,E as X,p as Y,v as Z,q as ee,s as j,x as ne,y as w}from"./index-j4ttCsna.js";import{g as te,v as oe,a as ae}from"./posts-Bixf2EQd.js";var ie=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],re=function(e){return ie.map(function(t){return t.toLowerCase()}).indexOf(e.toLowerCase())!==-1},le=function(e,t,n){Object.keys(t).filter(re).forEach(function(a){var i=t[a];typeof i=="function"&&(a==="onInit"?i(e,n):n.on(a.substring(2),function(r){return i(r,n)}))})},ue=function(e,t,n,a){var i=e.modelEvents?e.modelEvents:null,r=Array.isArray(i)?i.join(" "):i;E(a,function(s,u){n&&typeof s=="string"&&s!==u&&s!==n.getContent({format:e.outputFormat})&&n.setContent(s)}),n.on(r||"change input undo redo",function(){t.emit("update:modelValue",n.getContent({format:e.outputFormat}))})},de=function(e,t,n,a,i,r){a.setContent(r()),n.attrs["onUpdate:modelValue"]&&ue(t,n,a,i),le(e,n.attrs,a)},M=0,N=function(e){var t=Date.now(),n=Math.floor(Math.random()*1e9);return M++,e+"_"+n+M+String(t)},se=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},A=function(e){return typeof e>"u"||e===""?[]:Array.isArray(e)?e:e.split(" ")},ce=function(e,t){return A(e).concat(A(t))},fe=function(e){return e==null},U=function(){return{listeners:[],scriptId:N("tiny-script"),scriptLoaded:!1}},ve=function(){var e=U(),t=function(i,r,s,u){var o=r.createElement("script");o.referrerPolicy="origin",o.type="application/javascript",o.id=i,o.src=s;var d=function(){o.removeEventListener("load",d),u()};o.addEventListener("load",d),r.head&&r.head.appendChild(o)},n=function(i,r,s){e.scriptLoaded?s():(e.listeners.push(s),i.getElementById(e.scriptId)||t(e.scriptId,i,r,function(){e.listeners.forEach(function(u){return u()}),e.scriptLoaded=!0}))},a=function(){e=U()};return{load:n,reinitialize:a}},me=ve(),ge=function(){return typeof window<"u"?window:global},y=function(){var e=ge();return e&&e.tinymce?e.tinymce:null},pe={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},m=function(){return m=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},m.apply(this,arguments)},ye=function(e,t,n,a){return e(a||"div",{id:t,ref:n})},be=function(e,t,n){return e("textarea",{id:t,visibility:"hidden",ref:n})},O={selector:void 0,target:void 0},he=F({props:pe,setup:function(e,t){var n=e.init?m(m({},e.init),O):m({},O),a=K(e),i=a.disabled,r=a.modelValue,s=a.tagName,u=C(null),o=null,d=e.id||N("tiny-vue"),l=e.init&&e.init.inline||e.inline,_=!!t.attrs["onUpdate:modelValue"],b=!0,V=e.initialValue?e.initialValue:"",g="",I=function(c){return _?function(){return r!=null&&r.value?r.value:""}:function(){return c?V:g}},v=function(){var c=I(b),f=m(m({},n),{readonly:e.disabled,target:u.value,plugins:ce(n.plugins,e.plugins),toolbar:e.toolbar||n.toolbar,inline:l,setup:function(h){o=h,h.on("init",function(z){return de(z,e,t,h,r,c)}),typeof n.setup=="function"&&n.setup(h)}});se(u.value)&&(u.value.style.visibility=""),y().init(f),b=!1};E(i,function(c){var f;o!==null&&(typeof((f=o.mode)===null||f===void 0?void 0:f.set)=="function"?o.mode.set(c?"readonly":"design"):o.setMode(c?"readonly":"design"))}),E(s,function(c){var f;_||(g=o.getContent()),(f=y())===null||f===void 0||f.remove(o),B(function(){return v()})}),L(function(){if(y()!==null)v();else if(u.value&&u.value.ownerDocument){var c=e.cloudChannel?e.cloudChannel:"6",f=e.apiKey?e.apiKey:"no-api-key",h=fe(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/".concat(f,"/tinymce/").concat(c,"/tinymce.min.js"):e.tinymceScriptSrc;me.load(u.value.ownerDocument,h,v)}}),T(function(){y()!==null&&y().remove(o)}),l||(q(function(){b||v()}),G(function(){var c;_||(g=o.getContent()),(c=y())===null||c===void 0||c.remove(o)}));var R=function(c){var f;g=o.getContent(),(f=y())===null||f===void 0||f.remove(o),n=m(m(m({},n),c),O),B(function(){return v()})};return t.expose({rerender:R,getEditor:function(){return o}}),function(){return l?ye(x,d,u,e.tagName):be(x,d,u)}}});const Ce="u329pk89cumiwelx6b2b3sdup46m4f4byvfcfe2ei8g2oj00",_e={__name:"RichTextEditor",props:{modelValue:{type:String,default:""},disabled:{type:Boolean,default:!1},init:{type:Object,default:()=>({})}},emits:["change","onInit","update:modelValue"],setup(e,{emit:t}){const n=e,a=t,i=C(n.modelValue);E(()=>n.modelValue,o=>{i.value=o});const r=H(()=>({...{plugins:"lists link image table code help emoticons",language:"zh_CN",toolbar:"undo redo | styles | bold italic | alignleft aligncenter alignright alignjustify | outdent indent | numlist bullist | emoticons",height:"100%",resize:!1},...n.init})),s=o=>{a("update:modelValue",i.value),a("change",i.value,o)},u=(o,d)=>{a("onInit",d)};return(o,d)=>(k(),$(W(he),{modelValue:i.value,"onUpdate:modelValue":d[0]||(d[0]=l=>i.value=l),"api-key":Ce,onChange:s,onInit:u,init:r.value,disabled:e.disabled},null,8,["modelValue","init","disabled"]))}},Se={class:"content"},Ee={class:"editor-container"},Ve={class:"tool"},Ie={__name:"index",setup(e){const t=C(!1);L(()=>{te().then(d=>{console.log(d,"res")})});const n=C({title:""}),a=C(""),i=C(!1),r={},s=(d,l)=>{console.log("编辑器内容变化了:",d)},u=d=>{i.value=!0},o=d=>{if(!n.value.title){w.error("请输入标题");return}if(!a.value){w.error("请输入内容");return}t.value=!0,ae({title:n.value.title,content:a.value,published:d}).then(l=>{w.success(l.message||"操作成功"),n.value.title="",a.value="",t.value=!1}).catch(()=>{t.value=!1})};return(d,l)=>{const _=Y,b=X,V=ee,g=ne,I=oe;return D((k(),Q("div",Se,[p(V,{model:n.value,"label-width":"60px"},{default:S(()=>[p(b,{required:"",label:"标题："},{default:S(()=>[p(_,{modelValue:n.value.title,"onUpdate:modelValue":l[0]||(l[0]=v=>n.value.title=v)},null,8,["modelValue"])]),_:1}),p(b,{required:"",label:"内容："},{default:S(()=>[D(P("div",Ee,[p(_e,{modelValue:a.value,"onUpdate:modelValue":l[1]||(l[1]=v=>a.value=v),init:r,onChange:s,onOnInit:u},null,8,["modelValue"])],512),[[Z,i.value]])]),_:1})]),_:1},8,["model"]),P("div",Ve,[p(g,{onClick:l[2]||(l[2]=v=>o(!1))},{default:S(()=>l[4]||(l[4]=[j("暂存")])),_:1}),p(g,{type:"primary",onClick:l[3]||(l[3]=v=>o(!0))},{default:S(()=>l[5]||(l[5]=[j("发布")])),_:1})])])),[[I,!i.value||t.value]])}}},xe=J(Ie,[["__scopeId","data-v-c1a6eb30"]]);export{xe as default};
